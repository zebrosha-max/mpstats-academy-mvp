# Phase 4: Access Control & Personalization - Context

**Gathered:** 2026-02-25
**Status:** Ready for planning

<domain>
## Phase Boundary

Мягкое ограничение доступа к контенту уроков (видео, summary, чат) до прохождения диагностики + персонализированный трек обучения на основе SkillProfile. Генерация вопросов, хранение данных и security hardening — вне скоупа этой фазы.

</domain>

<decisions>
## Implementation Decisions

### Гейтинг контента
- Блокируется: видео + AI summary + RAG чат — весь контент урока недоступен без диагностики
- Страница урока открывается (пользователь может перейти по ссылке), но вместо контента — баннер с CTA
- Название урока и базовая информация остаются видимыми
- Проверка: наличие хотя бы одной завершённой DiagnosticSession у пользователя

### Стратегия рекомендаций
- Упор на слабые навыки: приоритет уроков из категорий с SkillProfile < 50
- Рекомендации строятся на основе последнего SkillProfile пользователя
- recommendedPath сохраняется в профиль и доступен между сессиями (требование из Success Criteria)

### UX фильтра "Мой трек"
- Empty state (без диагностики): баннер "Пройди диагностику чтобы получить персональный трек" + CTA кнопка на /diagnostic
- По умолчанию на /learn: "Мой трек" если диагностика пройдена, "Все курсы" если нет
- Прогресс-бар в шапке трека: "5/18 уроков завершено" с визуальной полоской

### Визуал баннера
- Тон текста: мотивирующий ("Пройди диагностику, чтобы получить доступ к урокам и персональный трек")
- Баннер заменяет область видео+summary+чат на странице урока

### Claude's Discretion
- Повторная диагностика: как обновляет трек (перестраивать или дополнять)
- Количество уроков в треке (все уроки слабых категорий vs фиксированный лимит)
- Порядок уроков в треке (по слабости категории, чередование, или иной)
- Механика переключателя на /learn (табы, toggle, или другой паттерн)
- Дизайн баннера на странице урока (полноэкранный vs компактный)
- Визуал бейджа "Рекомендовано" на карточках уроков
- Иконка замка на карточках в /learn (показывать или нет)
- Что происходит при завершении всех уроков трека

</decisions>

<specifics>
## Specific Ideas

- Прогресс-бар трека должен мотивировать — видимый счётчик "X/Y уроков"
- Empty state в "Мой трек" — не пустая страница, а целенаправленный CTA к диагностике
- Баннер на странице урока — позитивный, не "запрещающий"

</specifics>

<deferred>
## Deferred Ideas

None — discussion stayed within phase scope

</deferred>

---

*Phase: 04-access-control-personalization*
*Context gathered: 2026-02-25*
