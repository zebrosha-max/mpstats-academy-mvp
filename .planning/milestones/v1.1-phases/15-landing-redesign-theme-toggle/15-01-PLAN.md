---
phase: 15-landing-redesign-theme-toggle
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/web/src/app/globals.css
  - apps/web/src/components/shared/ThemeProvider.tsx
  - apps/web/src/components/shared/ThemeToggle.tsx
  - apps/web/src/app/layout.tsx
autonomous: true
requirements:
  - LANDING-02

must_haves:
  truths:
    - "ThemeProvider читает тему из localStorage при загрузке и применяет data-landing-theme атрибут"
    - "ThemeToggle переключает тему и сохраняет выбор в localStorage"
    - "CSS-переменные для light/dark тем определены в globals.css под [data-landing-theme] селекторами"
    - "При первом визите без localStorage используется light тема по умолчанию"
  artifacts:
    - path: "apps/web/src/components/shared/ThemeProvider.tsx"
      provides: "React context + provider для landing theme (light/dark)"
      min_lines: 30
    - path: "apps/web/src/components/shared/ThemeToggle.tsx"
      provides: "Sun/Moon иконка-кнопка для переключения темы"
      min_lines: 15
    - path: "apps/web/src/app/globals.css"
      provides: "CSS-переменные для landing light и dark тем"
      contains: "data-landing-theme"
  key_links:
    - from: "apps/web/src/components/shared/ThemeToggle.tsx"
      to: "apps/web/src/components/shared/ThemeProvider.tsx"
      via: "useTheme() context hook"
      pattern: "useTheme"
    - from: "apps/web/src/app/layout.tsx"
      to: "apps/web/src/components/shared/ThemeProvider.tsx"
      via: "LandingThemeProvider wraps children"
      pattern: "LandingThemeProvider"
---

<objective>
Создать инфраструктуру переключения тем для лендинга: CSS-переменные, React context provider и toggle-компонент.

Purpose: Фундамент для тематизируемого лендинга — Plan 02 будет использовать CSS-переменные и toggle.
Output: ThemeProvider, ThemeToggle, CSS-переменные в globals.css, layout.tsx обёрнут в provider.
</objective>

<execution_context>
@C:/Users/Zebrosha/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/Zebrosha/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/15-landing-redesign-theme-toggle/15-CONTEXT.md
@apps/web/src/app/globals.css
@apps/web/src/app/layout.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: CSS-переменные для landing light/dark тем + ThemeProvider + ThemeToggle</name>
  <files>
    apps/web/src/app/globals.css
    apps/web/src/components/shared/ThemeProvider.tsx
    apps/web/src/components/shared/ThemeToggle.tsx
    apps/web/src/app/layout.tsx
  </files>
  <action>
**1. CSS-переменные в globals.css:**

Добавить в конец globals.css (НЕ заменять существующие стили!) два блока переменных под `[data-landing-theme="light"]` и `[data-landing-theme="dark"]`:

Переменные (из CONTEXT.md):
```
--landing-bg: light=#FAFBFC, dark=#060B1F
--landing-text: light=#111827 (gray-900), dark=#FFFFFF
--landing-text-muted: light=#6B7280 (gray-500), dark=rgba(255,255,255,0.5)
--landing-text-faint: light=#D1D5DB (gray-300), dark=rgba(255,255,255,0.2)
--landing-border: light=rgba(229,231,235,0.6) (gray-200/60), dark=rgba(255,255,255,0.05)
--landing-card-bg: light=#FFFFFF, dark=rgba(255,255,255,0.03)
--landing-card-border: light=rgba(229,231,235,0.8), dark=rgba(255,255,255,0.06)
--landing-card-shadow: light=rgba(229,231,235,0.5), dark=transparent
--landing-green: light=#10B981, dark=#87F50F
--landing-nav-bg: light=rgba(255,255,255,0.9), dark=rgba(6,11,31,0.8)
--landing-glow-primary: light=rgba(44,79,248,0.03), dark=rgba(44,79,248,0.08)
--landing-glow-secondary: light=rgba(245,158,11,0.02), dark=rgba(135,245,15,0.05)
--landing-radar-fill: light=rgba(44,79,248,0.1), dark=rgba(44,79,248,0.25)
--landing-radar-stroke: light=#2C4FF8, dark=#4D6FFF
--landing-radar-grid: light=rgba(0,0,0,0.07), dark=rgba(255,255,255,0.12)
--landing-radar-axis: light=rgba(0,0,0,0.05), dark=rgba(255,255,255,0.12)
--landing-radar-label: light=rgba(0,0,0,0.4), dark=rgba(255,255,255,0.7)
--landing-radar-dot-stroke: light=white, dark=rgba(255,255,255,0.3)
--landing-progress-bg: light=#F3F4F6, dark=rgba(255,255,255,0.05)
--landing-badge-bg: light=rgba(44,79,248,0.08), dark=rgba(44,79,248,0.15)
--landing-badge-text: light=#2C4FF8, dark=#818CF8
--landing-badge-border: light=rgba(44,79,248,0.2), dark=rgba(44,79,248,0.3)
--landing-section-badge-bg: light=#F3F4F6, dark=rgba(255,255,255,0.05)
--landing-section-badge-text: light=#6B7280, dark=rgba(255,255,255,0.5)
--landing-section-badge-border: light=#E5E7EB, dark=rgba(255,255,255,0.1)
--landing-feature-icon-opacity: light=0.5, dark=0.4
--landing-feature-icon-hover-opacity: light=1, dark=0.7
--landing-glow-box-shadow: light=0 0 20px rgba(44,79,248,0.06), dark=0 0 20px rgba(44,79,248,0.15)
--landing-glow-box-shadow-active: light=0 0 40px rgba(44,79,248,0.12), dark=0 0 40px rgba(44,79,248,0.3)
--landing-selection-bg: light=rgba(44,79,248,0.15), dark=#2C4FF8
--landing-timeline-from: light=rgba(44,79,248,0.3), dark=rgba(44,79,248,0.5)
--landing-timeline-via: light=rgba(99,102,241,0.15), dark=rgba(129,140,248,0.3)
--landing-timeline-to: light=rgba(16,185,129,0.3), dark=rgba(135,245,15,0.5)
--landing-gradient-text-via: light=#6366F1, dark=#818CF8
--landing-gradient-text-to: light=#2C4FF8, dark=#87F50F
```

Синий акцент `#2C4FF8` одинаковый в обеих темах — не нужна переменная.

**2. ThemeProvider (`apps/web/src/components/shared/ThemeProvider.tsx`):**

```
'use client';

React context с:
- theme: 'light' | 'dark' (state)
- toggleTheme: () => void
- useEffect при монтировании:
  1. Читает localStorage.getItem('landing-theme')
  2. Если нет — 'light' по умолчанию
  3. document.documentElement.setAttribute('data-landing-theme', theme)
- useEffect при смене theme:
  1. document.documentElement.setAttribute('data-landing-theme', theme)
  2. localStorage.setItem('landing-theme', theme)
- Экспорт: LandingThemeProvider (component) + useTheme (hook)
```

FOUC prevention: в ThemeProvider добавить inline script pattern через useEffect + флаг mounted. До mounted рендерить children без задержки (SSR-safe). Альтернативно: маленький `<script>` в layout.tsx head для мгновенного чтения localStorage до React hydration — на усмотрение Claude, но FOUC должен быть минимален.

**3. ThemeToggle (`apps/web/src/components/shared/ThemeToggle.tsx`):**

```
'use client';

Компонент: кнопка с иконкой Sun (light) / Moon (dark).
- Использует useTheme() для получения theme и toggleTheme
- Иконки: inline SVG (Sun = circle + rays, Moon = crescent) — НЕ добавлять lucide-react зависимость для этого
- Размер кнопки: w-9 h-9 (компактная)
- Стили: text-[var(--landing-text-muted)] hover:text-[var(--landing-text)] transition-colors
- aria-label: "Переключить тему"
- CSS transition ~300ms на иконке (плавная смена per CONTEXT.md)
```

**4. Layout.tsx update:**

Обернуть children в `<LandingThemeProvider>` в корневом layout. Provider должен быть достаточно высоко чтобы и landing page и другие страницы имели к нему доступ (но тема используется только на лендинге — provider безвреден для внутренних страниц).

ВАЖНО: НЕ менять существующие стили/компоненты в layout.tsx. Только добавить provider wrapper.
  </action>
  <verify>
    <automated>cd D:/GpT_docs/MPSTATS\ ACADEMY\ ADAPTIVE\ LEARNING/MAAL && npx tsc --noEmit --project apps/web/tsconfig.json 2>&1 | head -20</automated>
    <manual>Проверить что globals.css содержит [data-landing-theme="light"] и [data-landing-theme="dark"] блоки, ThemeProvider и ThemeToggle экспортируются, layout.tsx содержит LandingThemeProvider</manual>
  </verify>
  <done>
    - globals.css содержит CSS-переменные для light и dark landing тем
    - ThemeProvider создан с localStorage persistence и data-landing-theme атрибутом
    - ThemeToggle создан с Sun/Moon иконками
    - layout.tsx обёрнут в LandingThemeProvider
    - TypeScript компилируется без ошибок
  </done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` проходит без ошибок
2. globals.css содержит `[data-landing-theme="light"]` и `[data-landing-theme="dark"]`
3. ThemeProvider.tsx экспортирует `LandingThemeProvider` и `useTheme`
4. ThemeToggle.tsx экспортирует компонент с Sun/Moon иконками
5. layout.tsx содержит `<LandingThemeProvider>`
</verification>

<success_criteria>
- CSS-переменные определены для обеих тем
- Theme provider работает с localStorage
- Toggle компонент готов к использованию в навигации лендинга
- Нет FOUC при загрузке страницы
- TypeScript компиляция проходит
</success_criteria>

<output>
After completion, create `.planning/phases/15-landing-redesign-theme-toggle/15-01-SUMMARY.md`
</output>
